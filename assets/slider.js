var Cfslider=new Class({options:{onChange:Class.empty,onComplete:function(){},onTick:function(t){this.moveKnob.setStyle(this.p,t)},start:0,end:1e3,offset:0,knobheight:20,knobwidth:20,mode:"horizontal",clip_w:0,clip_l:0,isinit:!0,snap:!1,range:!1,numsteps:null,module_id:null},initialize:function(t,s,i){var e,o,h=t+"_slider_gutter_m",n=t+"_knob_from",p=t+"_knob_to",a=t+"_slider_bkg_img";switch(this.module_id=s,this.setOptions(i),this.element=document.id(h),this.knob=document.id(n),this.previousChange=this.previousEnd=this.step=0,this.bkg=document.id(a),null==this.options.steps&&(this.options.steps=this.options.end-this.options.start),null!=p&&(this.maxknob=document.id(p)),this.options.mode){case"horizontal":this.z="x",this.p="left",e={x:"left",y:!1},o="offsetWidth";break;case"vertical":this.z="y",this.p="top",e={x:!1,y:"top"},o="offsetHeight"}this.max=this.element[o]-this.knob[o]+2*this.options.offset,this.half=this.knob[o]/2,this.full=this.element[o]-this.knob[o]+2*this.options.offset,this.min=this.options.range[0]||0===this.options.range[0]?this.options.range[0]:0,this.getPos=this.element["get"+this.p.capitalize()].bind(this.element),this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset),this.range=this.max-this.min,this.steps=this.options.steps||this.full,this.stepSize=Math.abs(this.range)/this.steps,this.stepWidth=this.stepSize*this.full/Math.abs(this.range),this.max_moved=!1,this.min_moved=!1,null!=p&&(this.maxPreviousChange=-1,this.maxPreviousEnd=-1,this.maxstep=this.options.end,this.maxknob.setStyle("position","relative").setStyle(this.p,+this.max-this.options.offset).setStyle("bottom",this.options.knobheight));var m={};m[this.z]=[-this.options.offset,this.max-this.options.offset],this.drag=new Drag(this.knob,{limit:m,modifiers:e,snap:0,onStart:function(){this.draggedKnob()}.bind(this),onDrag:function(){this.draggedKnob()}.bind(this),onComplete:function(){this.draggedKnob(),this.end()}.bind(this)}),null!=p&&(this.maxdrag=new Drag(this.maxknob,{limit:m,modifiers:e,snap:0,onStart:function(){this.draggedKnob(1)}.bind(this),onDrag:function(){this.draggedKnob(1)}.bind(this),onComplete:function(){this.draggedKnob(1),this.end()}.bind(this)})),this.options.snap&&(this.drag.options.grid=this.full/this.options.numsteps,this.drag.options.limit[this.z][1]=this.full,status="GRID - "+this.drag.options.grid+"  , full = "+this.full),this.options.initialize&&this.options.initialize.call(this)},setMin:function(t){return this.step=t.limit(this.options.start,this.options.end),this.checkStep(),this.end(!0),this.moveKnob=this.knob,this.bkg.style.clip="rect(0px "+(parseInt(this.toPosition(this.step))+3)+"px 10px 0px)",status=this.bkg.style.clip+"  vl= "+parseInt(this.toPosition(this.step)),this.fireEvent("onTick",this.toPosition(this.step)),this},setMax:function(t){this.maxstep=t.limit(this.options.start,this.options.end),this.checkStep(1),this.end(!0),this.moveKnob=this.maxknob;var s=Math.abs(this.toPosition(this.step)-this.toPosition(this.maxstep))+3,i=parseInt(this.clip_l+s);if(this.bkg.style.clip="rect(0px "+i+"px 10px "+this.clip_l+"px)",this.fireEvent("onTick",this.toPosition(this.maxstep)),this.options.isinit){var e,o,h={};e=-this.options.offset,o=parseInt(this.maxknob.getStyle("left"))-this.options.offset+8,h[this.z]=[e,o],this.drag.options.limit=h,this.options.isinit=!1}return this},clickedElement:function(t){var s=t.page[this.z]-this.getPos()-this.half;s=s.limit(-this.options.offset,this.max-this.options.offset),this.step=this.toStep(s),this.bkg.style.clip="rect(0px "+(parseInt(this.toPosition(this.step))+3)+"px 10px 0px)",this.checkStep(),this.end(),this.fireEvent("onTick",s)},draggedKnob:function(t){null==t?(this.step=this.toStep(this.drag.value.now[this.z]),this.checkStep()):(this.maxstep=this.toStep(this.maxdrag.value.now[this.z]),this.checkStep(1)),this.step<=this.maxstep?(this.maxstep==this.options.end&&0==this.max_moved||(this.max_moved=!0),this.step==this.options.start&&0==this.min_moved||(this.min_moved=!0),this.fireEvent("onMouseMove",{minpos:this.step,maxpos:this.maxstep,max_moved:this.max_moved,min_moved:this.min_moved})):this.fireEvent("onMouseMove",{minpos:this.maxstep,maxpos:this.step})},checkStep:function(t){var s,i={},e={};if(null==t?this.previousChange!=this.step&&(this.previousChange=this.step):this.maxPreviousChange!=this.maxstep&&(this.maxPreviousChange=this.maxstep),null!=this.maxknob){s=-this.options.offset,t=parseInt(this.maxknob.getStyle("left")),i[this.z]=[s,t],this.drag.options.limit=i,s=parseInt(this.knob.getStyle("left")),t=this.max-this.options.offset,e[this.z]=[s,t],this.maxdrag.options.limit=e,this.step<=this.maxstep?(this.maxstep==this.options.end&&0==this.max_moved||(this.max_moved=!0),this.step==this.options.start&&0==this.min_moved||(this.min_moved=!0),this.fireEvent("onChange",{minpos:this.step,maxpos:this.maxstep,max_moved:this.max_moved,min_moved:this.min_moved})):this.fireEvent("onChange",{minpos:this.maxstep,maxpos:this.step}),this.clip_l=parseInt(this.knob.getStyle("left"))+parseInt(parseInt(this.options.knobwidth)/2);var o=Math.abs(parseInt(this.knob.getStyle("left"))-parseInt(this.maxknob.getStyle("left"))),h=parseInt(this.clip_l+o);this.bkg.style.clip="rect(0px "+h+"px 10px "+this.clip_l+"px)"}else this.fireEvent("onChange",this.step),this.bkg.style.clip="rect(0px "+parseInt(this.drag.value.now[this.z])+"px 10px 0px)"},end:function(t){(this.previousEnd!==this.step||null!=this.maxknob&&this.maxPreviousEnd!=this.maxstep)&&(this.previousEnd=this.step,null!=this.maxknob?(this.maxPreviousEnd=this.maxstep,this.step<=this.maxstep&&!t?this.fireEvent("onComplete",{minpos:this.step+"",maxpos:this.maxstep+""}):t||this.fireEvent("onComplete",{minpos:this.maxstep+"",maxpos:this.step+""})):t||this.fireEvent("onComplete",this.step+""))},toStep:function(t){return step=Math.round((t+this.options.offset)/this.max*this.options.steps)+this.options.start,step},toPosition:function(t){return this.max*t/this.options.steps-this.max*this.options.start/this.options.steps-this.options.offset}});Cfslider.implement(new Events),Cfslider.implement(new Options);
